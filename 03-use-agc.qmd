<style>
.slide-deck {
    width: 100%;
    height: 475px;
}
</style>

# Use Case 1: Above Ground Carbon

As part of the Nature Returns research project with Natural England, the LIMMMA team worked with Kew Science on landscape-based carbon storage modelling.
This involved using habitat maps, remote sensing data and equations for estimating the amount of carbon stored above ground (in vegetation such as trees and hedgerows) and below ground (in soils) across a diverse landscape of woodland, grassland and built up areas at different scales including 1) Wakehurst site, 2) Wealden District Council, 3) Southeast England with potential to be scaled nationally.

In the following walkthrough we demonstrate how the above ground carbon models were created and tested using LIMMMA.

## Methodologies and Datasets

Our aim in this project was to create a workflow for generating and improving geospatial estimates of the amount of carbon stored above ground in the natural landscape which met the following requirements:

1. Use open access national datasets.
2. Scaleable from local to national.
3. Easily compare across different models at different scales.
4. Rapidly improve with new data, equations (e.g. allometric) and methodologies as they emerge from ongoing research.

The data and methods adopted are summarised in the following diagram.

![Above Ground Carbon data and methodology](images/03-screenshots-agc/03-05-agc-data-methodology.png){group="method"}

Two options for generating the habitat basemap for carbon estimates were imported: one from CEH and the other from LE.
LIDAR and Sentinel Satellite imagery provided the two options for topology estimation.
Additional data included CEH hedgerows and OS 25cm arial photography.
These data were variously used in different methods of carbon storage calculation using a cell-based approach.
The four methodologies listed below build on each other iteratively to progress towards a more precise estimate of carbon storage generated by increasingly complex models with potential for continuous improvement.

![Above Ground Carbon evolving methodologies](images/03-screenshots-agc/03-06-agc-methods-table.png){group="method"}

In the image below we can see how each model progressively improves the fidelity of carbon estimate maps by variously increasing their resolution and coverage.

![Above Ground Carbon model outputs showing increasing fidelity](images/03-screenshots-agc/03-07-agc-progression.png){group="method"}

And here is an example of the outputs from the model in LIMMMA map view at different scales.

![Example LIMMMA outputs](images/03-screenshots-agc/03-08-example-output.png){group="method"}

The following section describes how each of these models was built and how the outputs were created and analysed to draw conclusions about the different levels and sources of uncertainty associated with each.

## Implementing models

Each model was built in LIMMMA's graphical modelling system. The following diagram shows how this is used to connect data, methods and outputs in a single visual interface.

![Example LIMMMA model](images/03-screenshots-agc/03-09-example-model.png){group="model"}

In this section we present a series of step-by-step guides showing you how to reproduce the final feature height model from scratch. Each part of the process is illustrated in slide show format (see below).

:::{.callout-note}
Use slide show arrows or your keyboard arrow buttons to move through the slides. Hold down 'alt' and click to zoom in on a slide. Use the menu button at the bottom left of each slide show to open up the viewing options where you can see a list of the slides and the option to view in full screen.
:::

<iframe class="slide-deck" src="./slides/demo/03-01-open-model-view.html"></iframe>

### Select datasets

Having created a new project and set our desired extent, we can open the model view and start building. At first, you will be presented with a blank screen with no visible controls. Don't worry, the first thing to do is to add the various components you want to include in your model. This is done by simply right clicking the screen and selecting from a list of various types of components (see below). Datasets will include whatever your team has imported into your LIMMMA workspace. In addition to datasets there are numerous components for transforming inputs from those datasets in various ways and converting them into outputs for use in map view or in other models.

The first step in building our model is to add to the model the various datasets we need. This model only uses two:

1. Boolean dataset from the Living England Land Cover classification.
2. Numerical dataset of feature height derived from LIDAR imaging.

Let's first add these to the model.

<iframe class="slide-deck" src="./slides/demo/03-02-add-datasets.html"></iframe>

:::{.callout-note}
It is important to understand at this point that, when a dataset is added to a model it is converted to a raster format with cell dimensions adjusted to match the zoom level of the project. So whether it is a categorical, boolean or numerical dataset each dataset will share the same resolution. The zoom level is is determined according to the extent chosen when the project was created. However, the extent can also be adjusted from model view if you want to change to scale at which the model is run. This can be very useful when you need to run a model at different scales without having to rebuild it every time.
:::

### Combine datasets

Next we need to generate the broader categories of land cover class that we will use in the model. The first is a collection of land cover classes with little or no vegetation. This will not be computed with the feature height data but simply assigned a negligible average carbon density value (i.e. 0.001). The second is a collection of land cover classes that contain vegetation of various kinds and which will be computed with the feature height data and an equation to estimate carbon density based on the height of vegetation.

<iframe class="slide-deck" src="./slides/demo/03-03-combine-classes.html"></iframe>

### Transform data

Having added the datasets and organised the land cover classes we can start to use them to generate carbon storage estimates. The basic principle is to use the land cover categories ('No vegetation' and 'Vegetation') to mask numerical data that represents an estimate of biomass that can then be converted into an estimate of carbon stored per cell (i.e. per unit area) for each category. For simplicity we count all the land cover classes in the 'No vegetation' category as containing no biomass and therefore holding almost no stored carbon so we want to assign each 'No vegetation' cell the value 0.001.

<iframe class="slide-deck" src="./slides/demo/03-04-transform-no-veg.html"></iframe>

The next step is more complex. We now want to use the feature height (spatial numeric data) to estimate the carbon density distribution in all the 'vegetation' land cover classes. First we need to mask the feature height data with the 'vegetation' category and then we can use an equation to calculate estimates of biomass from the average feature height recorded for each cell. Here is how we do it.

<iframe class="slide-deck" src="./slides/demo/03-05-transform-veg.html"></iframe>

We are not finished with the vegetation category yet. To calculate an estimate of biomass based on the feature height measurements we need to use an equation from the 'Expression' component. In this example there are three expressions to choose from but it is possible to create any number of bespoke options using the 'Expressions' menu.

<iframe class="slide-deck" src="./slides/demo/03-06-expression.html"></iframe>

Now we have two maps of biomass: one for all land cover classes without vegetation and one for all land cover classes with vegetation. To create a single map for the whole landscape we need to merge these together.

<iframe class="slide-deck" src="./slides/demo/03-07-merge.html"></iframe>

Finally, we need to convert the estimate of biomass into above ground stored carbon (AGC). We will use the 'Multiply' and 'Numeric constant' components to convert to kg of carbon per m^2 and then into tons of carbon per hectare.

<iframe class="slide-deck" src="./slides/demo/03-08-convert.html"></iframe>

### Generate outputs

Now we have a model that generates a density map for above ground vegetative carbon we need to translate this into outputs for the map view and for use in other projects.

<iframe class="slide-deck" src="./slides/demo/03-09-outputs.html"></iframe>

## Exploring outputs

Switching to 'Map view' we can explore the new map layer visually alongside other map layers and also use the 'Snapshot' tool to view information for selected areas.

<iframe class="slide-deck" src="./slides/demo/03-10-map-view.html"></iframe>